<UserControl x:Class="Winhance.WPF.Features.SoftwareApps.Views.WindowsAppsHelpContent"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
             mc:Ignorable="d">
    
    <!-- Flyout Help Content -->
    <Border Background="{DynamicResource WindowBackground}"
            BorderBrush="#505050"
            BorderThickness="1"
            CornerRadius="4"
            Padding="15,10"
            MinWidth="500"
            MaxWidth="600"
            MaxHeight="450"
            Effect="{StaticResource LightShadowEffect}">
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Header -->
                <Grid Grid.Row="0" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0"
                               Text="Windows Apps Help"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource PrimaryTextColor}"
                               VerticalAlignment="Center"/>
                    
                    <Button Grid.Column="1"
                            x:Name="CloseButton"
                            Style="{StaticResource FlyOutCloseButtonStyle}"
                            ToolTip="Close Help"
                            Command="{Binding CloseHelpCommand}">
                        <iconPacks:PackIconMaterial Kind="Close" Width="12" Height="12"/>
                    </Button>
                </Grid>
            
                <!-- Status Indicators -->
                <Grid Grid.Row="1" Margin="0,5,0,15">
                <StackPanel>
                    
                    <StackPanel Orientation="Horizontal"
                                VerticalAlignment="Center"
                                Margin="0,0,0,10">
                        <!-- Installation Status -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,15,0">
                            <Ellipse Width="12"
                                     Height="12"
                                     Fill="#00FF3C"
                                     Margin="0,0,5,0"
                                     VerticalAlignment="Center"/>
                            <TextBlock Text="Installed"
                                       Foreground="{DynamicResource PrimaryTextColor}"
                                       FontSize="13"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,15,0">
                            <Ellipse Width="12"
                                     Height="12"
                                     Fill="#FF2800"
                                     Margin="0,0,5,0"
                                     VerticalAlignment="Center"/>
                            <TextBlock Text="Not Installed"
                                       Foreground="{DynamicResource PrimaryTextColor}"
                                       FontSize="13"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Reinstallability Status -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,15,0">
                            <iconPacks:PackIconMaterial Kind="Sync"
                                                     Width="16"
                                                     Height="16"
                                                     Foreground="#00A5FF"
                                                     Margin="0,0,5,0"
                                                     VerticalAlignment="Center"/>
                            <TextBlock Text="Can be Reinstalled"
                                       Foreground="{DynamicResource PrimaryTextColor}"
                                       FontSize="13"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="SyncOff"
                                                     Width="16"
                                                     Height="16"
                                                     Foreground="#FF2800"
                                                     Margin="0,0,5,0"
                                                     VerticalAlignment="Center"/>
                            <TextBlock Text="Cannot Reinstall"
                                       Foreground="{DynamicResource PrimaryTextColor}"
                                       FontSize="13"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal"
                                VerticalAlignment="Center"
                                Margin="0,0,0,10">
                        <!-- Winhance Removal Status -->
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="DeleteForever"
                                                     Width="18"
                                                     Height="18"
                                                     Foreground="#00A5FF"
                                                     Margin="0,0,5,0"
                                                     VerticalAlignment="Center"/>
                            <TextBlock Text="Winhance Status:"
                                       Foreground="{DynamicResource PrimaryTextColor}"
                                       FontSize="13"
                                       Margin="0,0,10,0"
                                       VerticalAlignment="Center"/>
                            
                            <!-- Removal Status Icons -->
                            <ItemsControl ItemsSource="{Binding RemovalStatusContainer.RemovalStatusItems}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Command="{Binding RemoveCommand}"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Padding="2"
                                                Margin="2,0"
                                                ToolTip="{Binding Name}"
                                                Cursor="Hand">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="Button">
                                                                <Border Background="{TemplateBinding Background}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        CornerRadius="2"
                                                                        Padding="{TemplateBinding Padding}">
                                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter Property="Background" Value="{DynamicResource ButtonHoverBackground}"/>
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </Button.Style>
                                            
                                            <Grid Width="16" Height="16">
                                                <!-- Loading Spinner -->
                                                <iconPacks:PackIconLucide Kind="LoaderCircle"
                                                                         Width="12"
                                                                         Height="12"
                                                                         Foreground="{DynamicResource PrimaryTextColor}"
                                                                         Opacity="0.7"
                                                                         VerticalAlignment="Center"
                                                                         HorizontalAlignment="Center"
                                                                         Margin="0,4,0,0"
                                                                         Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <iconPacks:PackIconLucide.RenderTransform>
                                                        <RotateTransform/>
                                                    </iconPacks:PackIconLucide.RenderTransform>
                                                    <iconPacks:PackIconLucide.Triggers>
                                                        <EventTrigger RoutedEvent="Loaded">
                                                            <BeginStoryboard>
                                                                <Storyboard RepeatBehavior="Forever">
                                                                    <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Angle"
                                                                                     From="0" To="360" Duration="0:0:1"/>
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </EventTrigger>
                                                    </iconPacks:PackIconLucide.Triggers>
                                                </iconPacks:PackIconLucide>
                                                
                                                <!-- Status Icon -->
                                                <iconPacks:PackIconMaterial Kind="{Binding IconKind}"
                                                                         Width="16"
                                                                         Height="16"
                                                                         VerticalAlignment="Center"
                                                                         HorizontalAlignment="Center">
                                                    <iconPacks:PackIconMaterial.Style>
                                                        <Style TargetType="iconPacks:PackIconMaterial">
                                                            <!-- Default (inactive) state - greyed out -->
                                                            <Setter Property="Foreground" Value="#808080"/>
                                                            <Setter Property="Opacity" Value="0.5"/>
                                                            <!-- Hide when loading -->
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsLoading}" Value="True">
                                                                    <Setter Property="Visibility" Value="Hidden"/>
                                                                </DataTrigger>
                                                                <!-- Active state - show brand colors -->
                                                                <DataTrigger Binding="{Binding IsActive}" Value="True">
                                                                    <Setter Property="Foreground" Value="{Binding ActiveColor}"/>
                                                                    <Setter Property="Opacity" Value="1.0"/>
                                                                </DataTrigger>
                                                                <!-- Special handling for Edge gradient effect -->
                                                                <MultiDataTrigger>
                                                                    <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding IsActive}" Value="True"/>
                                                                        <Condition Binding="{Binding Name}" Value="Microsoft Edge"/>
                                                                    </MultiDataTrigger.Conditions>
                                                                    <Setter Property="Foreground">
                                                                        <Setter.Value>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                                                <GradientStop Color="#00FF3C" Offset="0"/>
                                                                                <GradientStop Color="#0078D4" Offset="1"/>
                                                                            </LinearGradientBrush>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </MultiDataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </iconPacks:PackIconMaterial.Style>
                                                </iconPacks:PackIconMaterial> 
                                            </Grid>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
                </Grid>
                
                <!-- Info Text -->
                <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Info Text -->
                <TextBlock Grid.Column="1"
                           VerticalAlignment="Top"
                           HorizontalAlignment="Left"
                           FontSize="13"
                           TextWrapping="Wrap"
                           Margin="0,0,0,0"
                           Text="Click on an active Winhance removal status icon above to delete the script and task associated with it.&#x0a;&#x0a;App Removals:&#x0a;Select the item(s) you don't want on your PC (even not installed items) and remove them. Windows might try to add them back later, but Winhance will keep removing them for you if the scripts and scheduled tasks are active.&#x0a;&#x0a;App Installations:&#x0a;Select the item(s) you want to install and click on the 'Install Selected Items' button to start the installation.&#x0a;(Note: Only some apps can be reinstalled, see the indicator next to each item)&#x0a;&#x0a;Use the Search Box to find items quickly.&#x0a;The Save and Import Config buttons in the main window help you manage your preferred selections."/>
                </Grid>
            </Grid>
        </ScrollViewer>
    </Border>
</UserControl>
