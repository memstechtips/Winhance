<UserControl x:Class="Winhance.WPF.Features.SoftwareApps.Views.WindowsAppsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:Winhance.WPF.Features.SoftwareApps.ViewModels"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:local="clr-namespace:Winhance.WPF.Features.Common.Controls"
             xmlns:controls="clr-namespace:Winhance.WPF.Features.Common.Controls"
             xmlns:behaviors="clr-namespace:Winhance.WPF.Features.Common.Behaviors"
             xmlns:views="clr-namespace:Winhance.WPF.Features.SoftwareApps.Views"
             d:DataContext="{d:DesignInstance Type=viewModels:WindowsAppsViewModel}"
             mc:Ignorable="d">

    <Grid>
        
        <!-- Content Control to switch between views -->
        <ContentControl>
            <ContentControl.Style>
                <Style TargetType="ContentControl">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsTableViewMode}" Value="True">
                            <Setter Property="Content">
                                <Setter.Value>
                                    <views:WindowsAppsTableView/>
                                </Setter.Value>
                            </Setter>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding IsTableViewMode}" Value="False">
                            <Setter Property="Content">
                                <Setter.Value>
                                    <controls:ResponsiveScrollViewer>
                                        <StackPanel Margin="10">

        <!-- Checkboxes in a horizontal layout -->
        <StackPanel Orientation="Horizontal" Margin="15,10,0,10">
            <!-- Select All checkbox -->
            <CheckBox Style="{StaticResource CustomCheckBox}"
                      Content="Select All"
                      FontSize="16"
                      FontWeight="Bold"
                      IsChecked="{Binding IsAllSelected}"
                      Margin="0,0,20,0"/>

            <!-- Select All Installed checkbox -->
            <CheckBox Style="{StaticResource CustomCheckBox}"
                      Content="Select All Installed"
                      FontSize="16"
                      FontWeight="Bold"
                      IsChecked="{Binding IsAllSelectedInstalled}"
                      Margin="0,0,20,0"/>

            <!-- Select All Not Installed checkbox -->
            <CheckBox Style="{StaticResource CustomCheckBox}"
                      Content="Select All Not Installed"
                      FontSize="16"
                      FontWeight="Bold"
                      IsChecked="{Binding IsAllSelectedNotInstalled}"
                      Margin="0,0,0,0"/>
        </StackPanel>

        <!-- Windows Apps (Appx Packages) Section -->
        <StackPanel Orientation="Horizontal" Margin="0,5,0,5">
            <TextBlock Text="Windows Apps"
                      Style="{StaticResource SectionHeaderStyle}"/>
        </StackPanel>

        <ItemsControl ItemsSource="{Binding WindowsApps}"
                      Margin="10,0,10,10">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel Orientation="Horizontal" HorizontalAlignment="Left" />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemContainerStyle>
                <Style TargetType="ContentPresenter">
                    <Setter Property="Width" Value="280" />
                    <Setter Property="Margin" Value="0,0,0,0" />
                </Style>
            </ItemsControl.ItemContainerStyle>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <CheckBox Style="{StaticResource CustomCheckBox}"
                              Margin="5,5,5,5"
                              IsChecked="{Binding IsSelected}">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Style="{StaticResource AppStatusIndicatorStyle}"
                                     Fill="{Binding IsInstalled, Converter={StaticResource InstalledStatusToColorConverter}}">
                                <Ellipse.ToolTip>
                                    <ToolTip Content="{Binding IsInstalled, Converter={StaticResource InstalledStatusToTextConverter}}"/>
                                </Ellipse.ToolTip>
                            </Ellipse>

                            <!-- Reinstallability indicator -->
                            <materialDesign:PackIcon
                                Style="{StaticResource ReinstallabilityIndicatorStyle}"
                                Kind="{Binding CanBeReinstalled, Converter={StaticResource BooleanToReinstallableIconConverter}}"
                                Foreground="{Binding CanBeReinstalled, Converter={StaticResource StatusToColorConverter}}">
                                <materialDesign:PackIcon.ToolTip>
                                    <ToolTip Content="{Binding CanBeReinstalled, Converter={StaticResource BooleanToReinstallableTextConverter}}"/>
                                </materialDesign:PackIcon.ToolTip>
                            </materialDesign:PackIcon>

                            <TextBlock Text="{Binding Name}"
                                       Style="{StaticResource AppItemTextStyle}">
                                <TextBlock.ToolTip>
                                    <ToolTip Content="{Binding Description}"/>
                                </TextBlock.ToolTip>
                            </TextBlock>

                        </StackPanel>
                    </CheckBox>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <!-- Separator -->
        <Separator Style="{StaticResource SectionSeparatorStyle}"/>

        <!-- Capabilities Section -->
        <StackPanel Orientation="Horizontal" Margin="0,5,0,5">
            <TextBlock Text="Windows Capabilities"
                      Style="{StaticResource SectionHeaderStyle}"/>
        </StackPanel>

        <ItemsControl ItemsSource="{Binding Capabilities}"
                      Margin="10,0,10,10">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel Orientation="Horizontal" HorizontalAlignment="Left" />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemContainerStyle>
                <Style TargetType="ContentPresenter">
                    <Setter Property="Width" Value="280" />
                    <Setter Property="Margin" Value="0,0,0,0" />
                </Style>
            </ItemsControl.ItemContainerStyle>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <CheckBox Style="{StaticResource CustomCheckBox}"
                              Margin="5,5,5,5"
                              IsChecked="{Binding IsSelected}">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Style="{StaticResource AppStatusIndicatorStyle}"
                                     Fill="{Binding IsInstalled, Converter={StaticResource InstalledStatusToColorConverter}}">
                                <Ellipse.ToolTip>
                                    <ToolTip Content="{Binding IsInstalled, Converter={StaticResource InstalledStatusToTextConverter}}"/>
                                </Ellipse.ToolTip>
                            </Ellipse>

                            <!-- Reinstallability indicator -->
                            <materialDesign:PackIcon
                                Style="{StaticResource ReinstallabilityIndicatorStyle}"
                                Kind="{Binding CanBeReinstalled, Converter={StaticResource BooleanToReinstallableIconConverter}}"
                                Foreground="{Binding CanBeReinstalled, Converter={StaticResource StatusToColorConverter}}">
                                <materialDesign:PackIcon.ToolTip>
                                    <ToolTip Content="{Binding CanBeReinstalled, Converter={StaticResource BooleanToReinstallableTextConverter}}"/>
                                </materialDesign:PackIcon.ToolTip>
                            </materialDesign:PackIcon>

                            <TextBlock Text="{Binding Name}"
                                       Style="{StaticResource AppItemTextStyle}">
                                <TextBlock.ToolTip>
                                    <ToolTip Content="{Binding Description}"/>
                                </TextBlock.ToolTip>
                            </TextBlock>

                        </StackPanel>
                    </CheckBox>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <!-- Separator -->
        <Separator Style="{StaticResource SectionSeparatorStyle}"/>

        <!-- Optional Features Section -->
        <StackPanel Orientation="Horizontal" Margin="0,5,0,5">
            <TextBlock Text="Windows Optional Features"
                      Style="{StaticResource SectionHeaderStyle}"/>
        </StackPanel>

        <ItemsControl ItemsSource="{Binding OptionalFeatures}"
                      Margin="10,0,10,10">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel Orientation="Horizontal" HorizontalAlignment="Left" />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemContainerStyle>
                <Style TargetType="ContentPresenter">
                    <Setter Property="Width" Value="280" />
                    <Setter Property="Margin" Value="0,0,0,0" />
                </Style>
            </ItemsControl.ItemContainerStyle>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <CheckBox Style="{StaticResource CustomCheckBox}"
                              Margin="5,5,5,5"
                              IsChecked="{Binding IsSelected}">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Style="{StaticResource AppStatusIndicatorStyle}"
                                     Fill="{Binding IsInstalled, Converter={StaticResource InstalledStatusToColorConverter}}">
                                <Ellipse.ToolTip>
                                    <ToolTip Content="{Binding IsInstalled, Converter={StaticResource InstalledStatusToTextConverter}}"/>
                                </Ellipse.ToolTip>
                            </Ellipse>

                            <!-- Reinstallability indicator -->
                            <materialDesign:PackIcon
                                Style="{StaticResource ReinstallabilityIndicatorStyle}"
                                Kind="{Binding CanBeReinstalled, Converter={StaticResource BooleanToReinstallableIconConverter}}"
                                Foreground="{Binding CanBeReinstalled, Converter={StaticResource StatusToColorConverter}}">
                                <materialDesign:PackIcon.ToolTip>
                                    <ToolTip Content="{Binding CanBeReinstalled, Converter={StaticResource BooleanToReinstallableTextConverter}}"/>
                                </materialDesign:PackIcon.ToolTip>
                            </materialDesign:PackIcon>

                            <TextBlock Text="{Binding Name}"
                                       Style="{StaticResource AppItemTextStyle}">
                                <TextBlock.ToolTip>
                                    <ToolTip Content="{Binding Description}"/>
                                </TextBlock.ToolTip>
                            </TextBlock>

                            </StackPanel>
                    </CheckBox>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

                                        </StackPanel>
                                    </controls:ResponsiveScrollViewer>
                                </Setter.Value>
                            </Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ContentControl.Style>
        </ContentControl>
    </Grid>
</UserControl>
